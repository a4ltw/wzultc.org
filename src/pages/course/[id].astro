---
import Layout from '../../layouts/Layout.astro';

export function getStaticPaths() {
  const courses = [
    { id: '00', title: 'ç¬¬é›¶èª²', titleVi: 'BÃ i há»c 0', pages: 10, audioStart: 3 },
    { id: '01', title: 'ç¬¬ä¸€èª²', titleVi: 'BÃ i há»c 1', pages: 10, audioStart: 3 },
    { id: '02', title: 'ç¬¬äºŒèª²', titleVi: 'BÃ i há»c 2', pages: 10, audioStart: 3 },
    { id: '03', title: 'ç¬¬ä¸‰èª²', titleVi: 'BÃ i há»c 3', pages: 10, audioStart: 3 },
    { id: '04', title: 'ç¬¬å››èª²', titleVi: 'BÃ i há»c 4', pages: 10, audioStart: 3 },
    { id: '05', title: 'ç¬¬äº”èª²', titleVi: 'BÃ i há»c 5', pages: 10, audioStart: 3 },
    { id: '06', title: 'ç¬¬å…­èª²', titleVi: 'BÃ i há»c 6', pages: 10, audioStart: 3 },
  ];

  return courses.map(course => ({
    params: { id: course.id },
    props: { course }
  }));
}

const { id } = Astro.params;
const { course } = Astro.props;

// ç”¢ç”Ÿé é¢é™£åˆ—
const pageNumbers = Array.from({ length: course.pages }, (_, i) => i + 1);
const basePath = `/assets/course/${id}`;
---

<Layout title={`${course.title} - å°è¶Šç…§è­·è¯èª - WZULTC`}>
  <!-- Course Header -->
  <div class="bg-gradient-to-r from-blue-500 via-cyan-500 to-teal-500 text-white py-8 text-center">
    <h1 class="text-3xl md:text-4xl font-bold mb-2">
      {course.title} {course.titleVi}
    </h1>
    <p class="text-lg opacity-90">å°è¶Šç…§è­·è¯èª - å…¥é–€ç´š</p>
  </div>

  <!-- Navigation -->
  <div class="bg-white shadow-sm border-b sticky top-14 z-40">
    <div class="container mx-auto px-4 py-3 flex flex-wrap justify-between items-center gap-3">
      <div class="flex flex-wrap gap-3">
        <a href="/course" class="text-teal-600 hover:text-teal-700 font-medium">
          â† è¿”å›èª²ç¨‹åˆ—è¡¨ Quay láº¡i danh sÃ¡ch
        </a>
        <a href="/" class="text-gray-600 hover:text-gray-700">
          é¦–é  Trang chá»§
        </a>
      </div>
      <a
        href={`${basePath}/å°è¶Šç…§è­·è¯èª-å…¥é–€ç´š ${parseInt(id)}.pdf`}
        download
        class="bg-teal-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-teal-700 transition-colors"
      >
        ğŸ“¥ ä¸‹è¼‰ PDF Táº£i xuá»‘ng
      </a>
    </div>
  </div>

  <!-- Content -->
  <div class="container mx-auto px-4 py-8 max-w-4xl">
    {pageNumbers.map((pageNum) => {
      const pageStr = pageNum.toString().padStart(2, '0');
      const hasAudio = pageNum >= course.audioStart;

      return (
        <div class="mb-8">
          <img
            src={`${basePath}/page-${pageStr}.jpg`}
            alt={`ç¬¬ ${pageNum} é `}
            class="w-full rounded-lg shadow-lg bg-white p-2"
            loading="lazy"
          />
          <div class="mt-3 text-center">
            <p class="text-gray-500 text-sm mb-2">ç¬¬ {pageNum} é </p>
            {hasAudio && (
              <audio controls class="w-full max-w-md mx-auto" preload="metadata">
                <source src={`${basePath}/${id}-${pageStr}.mp3`} type="audio/mpeg" />
                æ‚¨çš„ç€è¦½å™¨ä¸æ”¯æ´éŸ³è¨Šæ’­æ”¾ã€‚
              </audio>
            )}
          </div>
        </div>
      );
    })}
  </div>

  <!-- Bottom Navigation -->
  <div class="bg-gray-100 border-t">
    <div class="container mx-auto px-4 py-4 flex flex-wrap justify-between items-center gap-3">
      <a href="/course" class="text-teal-600 hover:text-teal-700 font-medium">
        â† è¿”å›èª²ç¨‹åˆ—è¡¨ Quay láº¡i danh sÃ¡ch
      </a>
      <a
        href={`${basePath}/å°è¶Šç…§è­·è¯èª-å…¥é–€ç´š ${parseInt(id)}.pdf`}
        download
        class="bg-teal-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-teal-700 transition-colors"
      >
        ğŸ“¥ ä¸‹è¼‰ PDF Táº£i xuá»‘ng
      </a>
    </div>
  </div>
</Layout>
